<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Parameter estimation – Time Series Econometrics (TSE)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./TSE-ch7.html" rel="next">
<link href="./TSE-ch5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<!-- Use JavaScript to Disable Right-Click -->
<script>
document.addEventListener('contextmenu', event => event.preventDefault());
</script>

<!-- Custom JavaScript for toggling code visibility -->
<script>
function toggleCode(id) {
  var x = document.getElementById(id);
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }
}
</script>


<!-- Visibility selections. display: none;? 
  <style>

/* Initially hide elements */
.marginnotevideo {
  display: none;
}

.marginnote {
  display: none;
}

  </style>
-->

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles-TSE.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./TSE-ch6.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Parameter estimation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Econometrics (TSE)</a> 
        <div class="sidebar-tools-main">
    <a href="./msTSE2025.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A primer on time series models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stationary processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear process</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ARMA processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch6.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Parameter estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Model selection of ARMA model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Forecasting with ARMA models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Volatility modelling: AR-GARCH model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multivariate time series models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basics of vector autoregression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Nonstationary processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TSE-ch13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear regressions with I(1) variables</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#estimation-of-ar-models-with-ols" id="toc-estimation-of-ar-models-with-ols" class="nav-link active" data-scroll-target="#estimation-of-ar-models-with-ols"><span class="header-section-number">6.1</span> Estimation of AR models with OLS</a></li>
  <li><a href="#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation" class="nav-link" data-scroll-target="#maximum-likelihood-estimation"><span class="header-section-number">6.2</span> Maximum likelihood estimation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="part-ch6" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Parameter estimation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this section, we will consider how to estimate (unknown) values of the parameters of an ARMA(<span class="math inline">\(p,q\)</span>) model (or ARIMA(<span class="math inline">\(p,d,q\)</span>) model when introducing it in the latter Sections). In a nutshell, we observe the estimation to be possible with different methods depending on the model at hand:</p>
<ul>
<li><p>AR(<span class="math inline">\(p\)</span>): estimation can be done by (conditional) ordinary least squares (OLS).</p></li>
<li><p>ARMA(<span class="math inline">\(p,q\)</span>): due to the MA(<span class="math inline">\(q\)</span>) part, estimation is more complicated. However, estimation can be carried out by the method of maximum likelihood, which is naturally also available for the AR(<span class="math inline">\(p\)</span>) model as well.</p></li>
</ul>
<section id="estimation-of-ar-models-with-ols" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="estimation-of-ar-models-with-ols"><span class="header-section-number">6.1</span> Estimation of AR models with OLS</h2>
<p>Estimation of the AR(<span class="math inline">\(p\)</span>) model can be carried out with ordinary least squares (OLS), conditioning on the first <span class="math inline">\(p\)</span> observations. The AR(<span class="math inline">\(p\)</span>) model (including constant term) can be rewritten as <span class="math display">\[\begin{equation*}
y_t= \boldsymbol{x}^{\prime}_t \boldsymbol{\beta} + u_t,
\end{equation*}\]</span> where <span class="math inline">\(\boldsymbol{x}_t=[1 \quad y_{t-1} \, \cdots \, y_{t-p}]^{\prime}\)</span> and <span class="math inline">\(\boldsymbol{\beta}=[\nu \quad \phi_1 \, \cdots \, \phi_p]^{\prime}\)</span>. The OLS estimators of <span class="math inline">\(\boldsymbol{\beta}\)</span> (and <span class="math inline">\(\sigma^2\)</span>) can be constructed in the usual way familiar from past studies related to linear regression models. That is, the conditional OLS estimator of <span class="math inline">\(\boldsymbol{\beta}\)</span> is <span class="math display">\[\begin{equation*}
\widehat{\boldsymbol{\beta}} = \Big(\sum_{t=1}^T \boldsymbol{x}_t \boldsymbol{x}^{\prime}_t \Big)^{-1} \sum_{t=1}^T \boldsymbol{x}_t y_t.
\end{equation*}\]</span> In this case (notation), it is assumed that the required <span class="math inline">\(p\)</span> initial values <span class="math inline">\(y_{-p+1},\ldots, y_0\)</span> are available. Furthermore, the OLS estimator for <span class="math inline">\(\sigma^2\)</span> is <span class="math display">\[\begin{equation*}
\widehat{\sigma}^2 = \frac{1}{T} \sum_{t=1}^T \Big(y_t- \boldsymbol{x}^{\prime}_t \widehat{\boldsymbol{\beta}} \Big)^2.
\end{equation*}\]</span></p>
<ul>
<li>Notice that the summation in the OLS estimator starts from <span class="math inline">\(t=1,2,\ldots\)</span> due to these available initial values. Depending on, mainly notational choices, the OLS estimator is alternatively at times written as <span class="math display">\[\begin{equation*}
\widehat{\boldsymbol{\beta}} = \Big(\sum_{t=p+1}^T \boldsymbol{x}_t \boldsymbol{x}^{\prime}_t \Big)^{-1} \sum_{t=p+1}^T \boldsymbol{x}_t y_t,
\end{equation*}\]</span> if treating observations <span class="math inline">\(y_1,\ldots, y_p\)</span> as initial values.</li>
</ul>
<p>The usual (asymptotic) statistical properties of the resulting OLS estimator hold. In particular, it can be shown that:</p>
<ul>
<li><p>As the error term <span class="math inline">\(u_t\)</span> is uncorrelated with the lags of <span class="math inline">\(y_t\)</span>, we have <span class="math inline">\(\mathsf{E}(\boldsymbol{x}_t u_t)=\mathbf{0}\)</span>. That is, <span class="math inline">\(\mathsf{E}(u_t y_{t-j}) = 0\)</span> for <span class="math inline">\(j=1,2,\ldots,p\)</span>), and</p></li>
<li><p>the OLS estimator <span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span> is a consistent estimator of <span class="math inline">\(\boldsymbol{\beta}\)</span>.</p></li>
<li><p>Heteroskedasticity-autocorrelation consistent (HAC) standard errors, such as Newey-West standard errors, can, and often should, be automatically used to take the potential remaining conditional heteroskedasticity and autocorrelation in the residuals into account for detailed statistical inference (if this is the main objective in empirical analysis).</p></li>
</ul>
<p>&nbsp;</p>
</section>
<section id="maximum-likelihood-estimation" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="maximum-likelihood-estimation"><span class="header-section-number">6.2</span> Maximum likelihood estimation</h2>
<p>Estimation of ARMA (ARIMA) models with a moving average component is somewhat more complicated than the OLS based estimation of autoregressive models. The essential problem in estimating these models stems from the fact that <span class="math inline">\(u_t\)</span> is not observable.</p>
<p>The estimation of an ARMA(<span class="math inline">\(p,q\)</span>) model, including also the AR(<span class="math inline">\(p\)</span>), can be based on (conditional) method of maximum likelihood by making an assumption of the distribution of the error <span class="math inline">\(u_t\)</span>. A typical case would be to assume the error term is Gaussian <span class="math inline">\(u_t\sim \mathsf{nid}(0,\sigma^2)\)</span>.</p>
<ul>
<li><p>It is worth noting that regardless of the errors being exactly Gaussian or not, the maximum likelihood estimator (MLE) can be interpreted as a <strong>quasi-MLE (QMLE)</strong> where the possible error in the model specification can be taken into consideration by using a robust parameter covariance matrix in formulation of the standard errors.</p></li>
<li><p>We will come back to this QMLE interpretation within the context of AR-GARCH model. Similar argumentation as there can be used also in this context (without the GARCH errors).</p></li>
</ul>
<p>&nbsp;</p>
<p>We will next consider details on so called conditional maximum likelihood technique. The exact method (exact method of maximum likelihood) will be introduced at the end of next section in Extra material.</p>
<p>&nbsp;</p>
<p><strong>Conditional maximum likelihood method</strong>. The (exact) ML estimation of ARMA models requires the necessary selections for the initial values of <span class="math inline">\(y_t\)</span> and <span class="math inline">\(u_t\)</span>. By conditioning to the initial values, we get the conditional maximum likelihood technique. If the sample size (length of the time series) is large, the conditional and exact MLEs are close to each other (both lead to the same asymptotic distributions). Moreover, in practice, numerical methods can be used to maximize the log-likelihood function in both cases.</p>
<p>&nbsp;</p>
<p>Let us consider a concrete example case of an ARMA(1,1) model <span class="math display">\[\begin{equation*}
y_t = \nu + \phi_1 y_{t-1} + u_t + \theta_1 u_{t-1},
\end{equation*}\]</span> where <span class="math inline">\(u_t \thicksim \mathsf{nid}(0,\sigma^2)\)</span>. That is, the normality assumption of the error term is assumed. The goal is to estimate the vector of parameters <span class="math inline">\(\boldsymbol{\vartheta}=(\nu, \phi_1, \theta_1, \sigma^2)\)</span>.</p>
<ul>
<li><p>We use the notation <span class="math inline">\(\boldsymbol{\vartheta}\)</span> (“vartheta”) to denote a general parameter vector containing all the parameters of the model.</p></li>
<li><p>Even though we concentrate on the ARMA(1,1), the following argumentation generalizes readily to more general ARMA processes, which are of the form <span class="math inline">\(y_t = \mathsf{E}_{t-1}(y_t) + u_t\)</span> where <span class="math inline">\(\mathsf{E}_{t-1}(y_t)\)</span> corresponds to the employed model structure (systematic part of the model). Here <span class="math inline">\(\mathsf{E}_{t-1}(\cdot)\)</span> denotes the conditional expectation and it will be introduced more detail in Forecasting section. In this ARMA(1,1) case, we get <span class="math inline">\(\mathsf{E}_{t-1}(y_t) = \nu + \phi_1 y_{t-1} + \theta_1 u_{t-1}\)</span>, whereas, e.g., in the AR(<span class="math inline">\(p\)</span>) case we get <span class="math inline">\(\mathsf{E}_{t-1}(y_t) = \nu + \phi_1 y_{t-1} + \cdots + \phi_p y_{t-p}\)</span>.</p></li>
</ul>
<p>In the ARMA(1,1) model, taking the initial values for <span class="math inline">\(y_0\)</span> and <span class="math inline">\(u_0\)</span> as given, the sequence of <span class="math inline">\(u_1, \ldots, u_T\)</span> can be constructed from <span class="math inline">\(y_1, \ldots, y_T\)</span> by iterating <span class="math display">\[\begin{equation*}
u_t = y_t  - \nu - \phi_1 y_{t-1} - \theta_1 u_{t-1}, \quad t=1,\ldots,T.
\end{equation*}\]</span> When conditioning on <span class="math inline">\(y_{t-1}\)</span> and <span class="math inline">\(u_{t-1}\)</span>, which are included in the information available at time <span class="math inline">\(t-1\)</span>, we end up that the conditional distribution of <span class="math inline">\(y_t\)</span> that is (conditionally) normally distributed due to the normality assumption of <span class="math inline">\(u_t\)</span>: <span class="math display">\[\begin{equation*}
y_t|(y_{t-1}, u_{t-1}) \thicksim \mathsf{N}(\nu + \phi_1 y_{t-1} + \theta_1 u_{t-1}, \sigma^2).
\end{equation*}\]</span> The specific form of the conditional density function of <span class="math inline">\(y_t\)</span>, conditional on <span class="math inline">\(y_{t-1}\)</span> and <span class="math inline">\(u_{t-1}\)</span>, is hence <span class="math display">\[\begin{equation*}
f_{y_t|y_{t-1}, u_{t-1}}(y_t|y_{t-1}, u_{t-1}; \boldsymbol{\vartheta}) = \frac{1}{\sqrt{2 \pi \sigma^2}} \mathrm{exp} \Big(- \frac{(y_t - \nu - \phi_1 y_{t-1} - \theta_1 u_{t-1})^2}{2 \sigma^2}  \Big).
\end{equation*}\]</span></p>
<p>&nbsp;</p>
<p><strong>Construction of the log-likelihood function</strong>. The (conditional) log-likelihood function can based on the conditional density functions for single observations. Here we are not just restricting ourselves to the ARMA(1,1) and/or Gaussian case. That is the following steps can be generalized also to other modelling choices such as ARMA models.</p>
<p>Denote <span class="math inline">\(\ubar{\mathbf{Y}}_{t}= (y_1 \ldots y_t)\)</span> and, therefore, the sample of observations is denoted by <span class="math inline">\(\ubar{\mathbf{Y}}_T=(y_1, \ldots y_T)\)</span>. The joint conditional density function (without arguments) <span class="math inline">\(f_{\ubar{\mathbf{Y}}_{T}}(\ubar{\mathbf{Y}}_{T})\)</span> is obtained as the product of conditional density functions <span class="math display">\[\begin{equation*}
f_{\ubar{\mathbf{Y}}_T}=f_{y_T|\ubar{\mathbf{Y}}_{T-1}}\cdot f_{\ubar{\mathbf{Y}}_{T-1}}=f_{y_T|\ubar{\mathbf{Y}}_{T-1}} f_{y_{T-1}|\ubar{\mathbf{Y}}_{T-2}}\cdot f_{\ubar{\mathbf{Y}}_{T-2}}=\cdots=\prod_{t=1}^{T} f_{y_t|\ubar{\mathbf{Y}}_{t-1}}\cdot f_{\ubar{\mathbf{Y}}_0}.
\end{equation*}\]</span> By conditioning on <span class="math inline">\(\ubar{\mathbf{Y}}_0\)</span>, which contains the necessary initial values (depending on, e.g., the lag lengths <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> of the ARMA(<span class="math inline">\(p,q\)</span>) model), the conditional density function gets the form <span class="math display">\[\begin{equation*}
    \prod_{t=1}^{T} f_{y_t|\ubar{\mathbf{Y}}_{t-1}},
\end{equation*}\]</span> which then leads to the the (conditional) log-likelihood function <span class="math display">\[\begin{eqnarray*}
l(\boldsymbol{\vartheta}) = \sum_{t=1}^{T} \mathrm{log} \, f_{y_t|\ubar{\mathbf{Y}}_{t-1}}(y_t|\ubar{\mathbf{Y}}_{t-1}; \boldsymbol{\vartheta}).
\end{eqnarray*}\]</span></p>
<ul>
<li>Going back to the specific example of Gaussian ARMA(1,1) model, the conditional log-likelihood function is hence <span class="math display">\[\begin{eqnarray*}
l(\boldsymbol{\vartheta}) = -\frac{T}{2} \mathrm{log}(2 \pi) - \frac{T}{2} \mathrm{log}(\sigma^2) - \frac{1}{2 \sigma^2} \sum_{t=1}^{T}
u^2_t,
\end{eqnarray*}\]</span> where <span class="math inline">\(u_t = y_t - \nu - \phi_1 y_{t-1} - \theta_1 u_{t-1}\)</span> in this ARMA(1,1) case.</li>
</ul>
<p>The maximum likelihood estimate (MLE) of <span class="math inline">\(\boldsymbol{\vartheta}\)</span>, that is <span class="math inline">\(\widehat{\boldsymbol{\vartheta}}\)</span>, is obtained by maximizing the conditional log-likelihood function.</p>
<ul>
<li>This requires numerical optimization methods. These numerical (iterative) algorithms require initial values and/or possibly also preliminary estimation of the parameters, but econometric and statistical program packages are carrying out these steps straightforwardly.</li>
</ul>
<p>&nbsp;</p>
<p><strong>AR(<span class="math inline">\(p\)</span>) case</strong>. We will next show that, in the case of the AR(<span class="math inline">\(p\)</span>) model, the conditional maximum likelihood estimation actually leads to the (conditional) least squares estimates when the error term is Gaussian (<span class="math inline">\(u_t \thicksim \mathrm{nid}(0, \sigma^2)\)</span>).</p>
<p>Since <span class="math inline">\(y_t\)</span> is a linear combination of <span class="math inline">\(u_t, u_{t-1}, \ldots\)</span> (given stationarity and corresponding MA(<span class="math inline">\(\infty\)</span>) representation), it follows that <span class="math inline">\(u_s\)</span> and <span class="math inline">\(\boldsymbol{x}_t\)</span> are independent <span class="math inline">\(\forall s \ge t\)</span>, where, as above in the AR(<span class="math inline">\(p\)</span>) case, <span class="math inline">\(\boldsymbol{x}_t=[1 \quad y_{t-1} \, \cdots \, y_{t-p}]^{\prime}\)</span>. By assuming the normality of the error term, we get <span class="math display">\[\begin{equation*}
    y_t|\ubar{\mathbf{Y}}_{t-1} \thicksim \mathsf{N}(\boldsymbol{x}^{'}_t \boldsymbol{\beta}, \sigma^2),
\end{equation*}\]</span> and the conditional density function of <span class="math inline">\(y_t\)</span> is <span class="math display">\[\begin{equation*}
    f_{y_t|\ubar{\mathbf{Y}}_{t-1}}(y_t|\boldsymbol{x}_t) = \frac{1}{\sqrt{2 \pi \sigma^2}}\mathrm{exp}\Big(-\frac{1}{2\sigma^2}(y_t -\boldsymbol{x}^{'}_t \boldsymbol{\beta})^2 \Big).
\end{equation*}\]</span> From this we get the (sample) log-likelihood function <span class="math display">\[\begin{equation*}
l(\boldsymbol{\vartheta}) \equiv l(\boldsymbol{\beta}, \sigma^2)=-\frac{T}{2} \mathrm{log}(2\pi)-\frac{T}{2} \mathrm{log}(\sigma^2)-\frac{1}{2\sigma^2}\sum_{t=1}^{T}(y_t-\boldsymbol{x}^{'}_t \boldsymbol{\beta})^2.
\end{equation*}\]</span> where the first term can also be removed because it does not depend on the parameters <span class="math inline">\(\boldsymbol{\vartheta}\)</span>. This corresponds the (conditional) log-likelihood function of a Gaussian linear regression model, but now for time series observation <span class="math inline">\((y_1,\ldots, y_T)\)</span>. Maximizing this gives us the same conditional least squares estimator <span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span> (and <span class="math inline">\(\widehat{\sigma}^2\)</span>) as obtained above.</p>
<p>&nbsp;</p>
<p><strong>Exact method of maximum likelihood</strong>. The exact log-likelihood function contains also the impact of initial values when constructing the log-likelihood function. Some details on this technique is provided below.</p>
<p>&nbsp;</p>
<div class="toggle-button" onclick="toggleCode('Extra10')">
Extra: Exact maximum likelihood estimation of ARMA models
</div>
<div id="Extra10" style="display:none;">
<p>Let us take a closer look at exact maximum likelihood (ML) based estimation.</p>
<p><strong>The exact likelihood function</strong>. For the purpose of estimation based on the exact method of maximum likelihood, consider the ARMA(<span class="math inline">\(p,q\)</span>) process <span class="math display">\[\begin{equation*}
    y_{t} = \nu + \phi_{1}y_{t-1}+\cdots+\phi_{p}y_{t-p}+u_{t}+\theta_{1}u_{t-1}+\cdots+\theta_{q}u_{t-q},\,\, u_{t}\sim\mathsf{nid}\left(  0,\sigma^{2}\right),
\end{equation*}\]</span> and assume the stationarity, invertibility and the identification condition of the ARMA process hold. Suppose <span class="math inline">\(\boldsymbol{y}=\left(  y_{1},\ldots,y_{T}\right)\)</span> is a vector of observations generated by this process. As before, denote <span class="math inline">\(\boldsymbol{\phi}=(\phi_{1},\ldots,\phi_{p})\)</span>, <span class="math inline">\(\boldsymbol{\theta}=\left(  \theta_{1},\ldots,\theta_{q}\right)\)</span> and <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}=(\boldsymbol{\phi},\boldsymbol{\theta})\)</span>. Making use of the general formulas for the mean and autocovariance function of a linear process, it can be seen that <span class="math inline">\(\mathsf{E}\left(\boldsymbol{y}\right) = \boldsymbol{0}\)</span> and <span class="math inline">\(\mathsf{Cov}\left(  \boldsymbol{y}\right)  =\sigma^{2} \boldsymbol{\Sigma}\)</span>, where the (positive definite) matrix <span class="math inline">\(\boldsymbol{\Sigma} = \boldsymbol{\Sigma}\left(\boldsymbol{\boldsymbol{\beta}}\right)\)</span> <span class="math inline">\(\left(  T\times T\right)\)</span> is a function of the parameter <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span>&nbsp;(but not of the parameter <span class="math inline">\(\sigma^{2}\)</span>).</p>
<p>Since linear transformations of Gaussian distributions are also Gaussian (this holds also for infinite dimensional transformations), <span class="math inline">\(\boldsymbol{y}\sim \mathsf{N}\left(\boldsymbol{0},\sigma ^{2} \boldsymbol{\Sigma} \right)\)</span>.</p>
<ul>
<li>In addition to the constant term, a trend component can be inserted in without affecting the asymptotic properties of the ML-estimators for<span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span> and <span class="math inline">\(\sigma ^{2}\)</span>.</li>
</ul>
<p>The density function of the random vector <span class="math inline">\(\boldsymbol{y}\)</span> is <span class="math display">\[\begin{equation*}
    f_{\boldsymbol{y}}\left( \boldsymbol{y}\right) =\left( 2\pi \right) ^{-T/2}\det\left( \sigma ^{2}\boldsymbol{\Sigma }\right) ^{-1/2}\exp\left\{ -\frac{1}{2\sigma ^{2}}\boldsymbol{y}^{\prime}\boldsymbol{\Sigma}^{-1}\boldsymbol{y}\right\} .
\end{equation*}\]</span> Making use of properties of the determinant, <span class="math inline">\(\det\left(  \sigma^{2}\boldsymbol{\Sigma}\right)=\sigma^{2T}\det\left(\boldsymbol{\Sigma}\right)\)</span>, so that the log likelihood function becomes <span class="math display">\[\begin{equation*}
    l\left( \boldsymbol{\beta},\sigma ^{2}\right) =-\frac{T}{2}\log \sigma ^{2}-\frac{1}{2}\log \det \left(\boldsymbol{\Sigma }\left( \boldsymbol{\beta} \right)\right) -\frac{1}{2\sigma ^{2}}\boldsymbol{y}^{\prime }\boldsymbol{\Sigma}\left(\boldsymbol{\beta} \right) ^{-1}\boldsymbol{y}.
\end{equation*}\]</span> Because the matrix <span class="math inline">\(\boldsymbol{\Sigma}\left(  \boldsymbol{\boldsymbol{\beta}}\right)\)</span>&nbsp;is a rather complicated function of the parameter <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span>, the log-likelihood function cannot be expressed in a simple form and, consequently, the above expression is difficult to be used directly to maximize the likelihood function. In practice, one has to resort to numerical methods to maximize the likelihood function. This involves computing the inverse matrix <span class="math inline">\(\boldsymbol{\Sigma}\left(  \boldsymbol{\boldsymbol{\beta}}\right)  ^{-1}\)</span>&nbsp;and the determinant <span class="math inline">\(\det\left(  \boldsymbol{\Sigma}\left(  \boldsymbol{\boldsymbol{\beta}}\right)\right)\)</span>&nbsp;for a range of given values of <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span>. For a given value of <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span>, the matrix <span class="math inline">\(\boldsymbol{\Sigma}\left(  \boldsymbol{\boldsymbol{\beta}}\right)\)</span>&nbsp;can be computed for ARMA processes.</p>
<p>Many different algorithms have been proposed to solve the maximization problem described above.</p>
</div>
<p>&nbsp;</p>
<p><strong>Statistical inference</strong>. It can be shown that when the stationarity, invertibility, and identification conditions hold, the “usual” asymptototic properties of an maximum likelihood estimator (exact or conditional) hold. In particular, the estimators <span class="math inline">\(\boldsymbol{\widehat{\boldsymbol{\beta}}}\)</span>&nbsp;and <span class="math inline">\(\widehat{\sigma}^{2}\)</span> are both consistent, asymptotically normally distributed and asymptotically independent. In other words, it holds <span class="math display">\[\begin{equation*}
    \boldsymbol{\widehat{\boldsymbol{\beta}}}\underset{as}{\sim}\mathsf{N}\left(\boldsymbol{\boldsymbol{\beta}},
    \boldsymbol{\mathrm{V}}\left(\boldsymbol{\boldsymbol{\beta}}\right)^{-1}\right),
\end{equation*}\]</span> where the matrix <span class="math inline">\(\boldsymbol{\mathrm{V}}\left(\boldsymbol{\boldsymbol{\beta}}\right)=\mathsf{E}\left[-\partial^{2}l(\boldsymbol{\boldsymbol{\beta}},\sigma^{2})/\partial\boldsymbol{\boldsymbol{\beta}}\partial\boldsymbol{\boldsymbol{\beta}}^{\prime})\right]\)</span> is the so-called Fisher information matrix of the parameter <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span></p>
<ul>
<li><p>The asymptotic distribution result holds also without the normality assumption, although in that case the estimators are no longer (asymptotically)&nbsp;efficient.</p></li>
<li><p>It should be noted that the stationarity, invertibility, and identification conditions are required for the above asymptotic distribution result, which can give a poor approximation also when these conditions are “nearly violated”.</p></li>
</ul>
<p>&nbsp;</p>
<p><strong>Hypothesis testing</strong>. Using the empirical counterpart of <span class="math inline">\(\boldsymbol{\mathrm{V}}\left(\boldsymbol{\boldsymbol{\beta}}\right)\)</span>, namely <span class="math inline">\(\widehat{\boldsymbol{\mathrm{V}}}(\boldsymbol{\widehat{\boldsymbol{\beta}},\widehat{\sigma}^{2}})=-\partial^{2}l(\boldsymbol{\widehat{\boldsymbol{\beta}}},\widehat{\sigma}^{2})/\partial\boldsymbol{\boldsymbol{\beta}}\partial\boldsymbol{\boldsymbol{\beta}}^{\prime}\)</span> (the so-called empirical or observed information matrix of the parameter <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span>), the asymptotic distribution result above can be used to construct statistical Wald tests and confidence intervals concerning the parameter <span class="math inline">\(\boldsymbol{\boldsymbol{\beta}}\)</span></p>
<ul>
<li>The partial derivatives appearing in this expression can in practice be approximated with their numerical counterparts.</li>
</ul>
<p>In particular, the square roots of the diagonal elements of the matrix <span class="math inline">\(\widehat{\boldsymbol{\mathrm{V}}}(\boldsymbol{\widehat{\boldsymbol{\beta}}},\widehat{\sigma}^{2}\boldsymbol{)}^{-1}\)</span> can be used as approximate standard errors of the components of the estimator <span class="math inline">\(\boldsymbol{\widehat{\boldsymbol{\beta}}}\)</span>.</p>
<ul>
<li>For instance, an individual (<span class="math inline">\(i\)</span>th) estimated component of <span class="math inline">\(\boldsymbol{\widehat{\boldsymbol{\beta}}}\)</span>, that is <span class="math inline">\(\boldsymbol{\widehat{\boldsymbol{\beta}}}_i\)</span>, would be interpreted as “significantly” different from zero if its absolute value is at least 2 (specifically 1.96) times the size of its approximate standard error.</li>
</ul>
<p>Formally, let us denote <span class="math inline">\(\boldsymbol{\mathrm{V}}(\boldsymbol{\beta})^{-1} = [v^{ij}]\)</span>, its empirical counterpart is <span class="math inline">\(\widehat{\boldsymbol{\mathrm{V}}}(\widehat{\boldsymbol{\beta}}, \widehat{\sigma}^2)^{-1} = [\widehat {v}^{ij}]\)</span>, and <span class="math display">\[\begin{equation*}
    \widehat{\boldsymbol{\beta}}_i \underset{as.}{\thicksim} \mathsf{N}(\boldsymbol{\beta}_i, v^{ii}).
\end{equation*}\]</span> Thus null hypothesis <span class="math inline">\(\beta_i=0\)</span> gets rejected at the 5% significance level if the <span class="math inline">\(t\)</span>-ratio (cf.&nbsp;<span class="math inline">\(t\)</span>-test) <span class="math display">\[\begin{equation*}
    \Big|\frac{\widehat{\boldsymbol{\beta}}_i}{\sqrt{\widehat {v}^{ii}}}\Big|\ge 1.96 \Leftrightarrow|\widehat{\boldsymbol{\beta}}_i| \ge 1.96 \sqrt{\widehat {v}^{ii}}
\end{equation*}\]</span> and the 95% confidence intervals for <span class="math inline">\(\beta_i\)</span> can be obtained by <span class="math display">\[\begin{equation*}
    \widehat{\beta}_i \pm 1.96 \cdot \mathrm{s.e.}(\widehat{\beta}_i) =1.96\sqrt{\widehat {v}^{ii}}.
\end{equation*}\]</span> Tests constructed using likelihood ratio principles can also be used in a conventional manner.</p>
<p>&nbsp;</p>
<p><strong>Empirical example</strong>. In the previous section, we concluded an AR(2) model to be one possible candidate for the quarterly U.S real GDP growth (1985:Q1–2007:Q2). The conditional maximum likelihood estimation of this model gives us <span class="math display">\[\begin{equation*}
    y_{t} = \underset{\left(0.197\right) }{1.693} + \underset{\left(0.101\right) }{0.160} y_{t-1} + \underset{\left(0.101\right) }{0.287} y_{t-1} + \widehat{u}_{t}, \quad \widehat{\sigma}^{2}=3.536,
\end{equation*}\]</span> where in parentheses under the estimates are the approximate standard errors. Especially the estimate for the AR(2) coefficient is statistically significant at the 5% significance level and hence the model cannot be shrinked.</p>
<p>Alternatively, if reporting the estimation result for the demeaned process, we then obtain <span class="math display">\[\begin{equation*}
    \bar{y}_{t} = \underset{\left(0.101\right) }{0.160}\bar{y}_{t-1} + \underset{\left(0.102\right) }{0.287}\bar{y}_{t-2} +\widehat{u}_{t},
\end{equation*}\]</span> where <span class="math inline">\(\bar{y}_{t}=y_{t}-3.061\)</span> is the demeaned GDP growth series.</p>
<p>&nbsp;</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./TSE-ch5.html" class="pagination-link" aria-label="ARMA processes">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ARMA processes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./TSE-ch7.html" class="pagination-link" aria-label="Model selection of ARMA model">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Model selection of ARMA model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>